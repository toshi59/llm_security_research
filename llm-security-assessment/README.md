# 生成AIモデルセキュリティアセスメントシステム

Next.jsベースのWebアプリケーションで、生成AIモデルのセキュリティアセスメントを**閲覧（匿名OK）**と**実行（管理者のみ）**できます。データはUpstash Redisに保存され、調査はTavily＋GPT-4で自動実行されます。

## 機能

### 🔍 **包括的なアセスメント**
- **40項目の評価基準**: 法規制、セキュリティ、AI倫理、技術的健全性など
- **自動調査機能**: Tavily APIとGPT-4を活用した情報収集と評価
- **リアルタイム進捗表示**: ステップ別の詳細進捗とプログレスバー

### 📊 **データ可視化**
- **モデル別・カテゴリ別表示**: 折りたたみ可能なアコーディオン形式
- **インタラクティブダッシュボード**: 統計情報とチャートで全体像を把握
- **アセスメントサマリ**: 各モデルの評価結果を200-300文字で要約表示

### 🔗 **証跡管理**
- **クリック可能なURL**: 証跡・根拠のURLが自動でリンク化
- **エビデンスベースの評価**: 外部リンクで情報源を確認可能
- **詳細スライドオーバー**: 評価項目の詳細情報とエビデンス表示

### 🛡️ **データ管理**
- **重複排除機能**: 同一モデルの古いアセスメントを自動削除
- **評価モデル数統計**: ダッシュボードで評価済みモデル数を表示
- **セキュアな認証**: JWT認証による管理者権限と監査ログ

### 🎨 **ユーザーエクスペリエンス**
- **レスポンシブUI**: サイドバー固定レイアウトで使いやすさを重視
- **ライトテーマ統一**: 全ページで一貫したホワイト背景デザイン
- **アクセシビリティ対応**: 直感的なナビゲーションと視認性の高いUI

## 技術スタック

- **Framework**: Next.js 15.5.2 (App Router, TypeScript)
- **UI**: Tailwind CSS v4 + shadcn/ui + Lucide React
- **Database**: Upstash Redis (JSON API) + ULID
- **Authentication**: JWT + bcrypt (HTTP-only cookies)
- **External APIs**: Tavily Search API, OpenAI GPT-4
- **Build System**: Webpack & Turbopack対応
- **Validation**: Zod schema validation
- **Deployment**: Vercel

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 環境変数の設定

`.env.example`を`.env`にコピーして、必要な値を設定してください：

```bash
cp .env.example .env
```

必要な環境変数：
- `UPSTASH_REDIS_REST_URL`: Upstash RedisのREST URL
- `UPSTASH_REDIS_REST_TOKEN`: Upstash Redisのトークン
- `TAVILY_API_KEY`: Tavily Search APIキー
- `OPENAI_API_KEY`: OpenAI APIキー
- `ADMIN_USERNAME`: 管理者ユーザー名（デフォルト: admin）
- `ADMIN_PASSWORD_HASH`: 管理者パスワードのbcryptハッシュ（未設定時は'0000'）
- `JWT_SECRET`: JWTシークレットキー

### 3. 開発サーバーの起動

```bash
# Turbopack使用（高速、実験的）
npm run dev

# Webpack使用（安定）- 推奨
npm run dev:webpack

# 特定ポート指定
npm run dev:webpack -- --port 3011
```

http://localhost:3000 (または指定ポート) でアプリケーションが起動します。

> **注意**: Turbopackでエラーが発生する場合は `npm run dev:webpack` を使用してください。

## 使用方法

### ホーム画面 (`/`)
- **評価項目一覧**: 40項目のセキュリティ評価基準をカテゴリ別に表示
- **アコーディオン形式**: カテゴリごとに折りたたみ可能な表示
- **詳細情報**: 各項目の評価基準、標準、リスクレベルを確認可能

### アセスメント結果画面 (`/assessments`)
- **ダッシュボード切り替え**: 統計概要と詳細結果の切り替え表示
- **モデル別・カテゴリ別表示**: 折りたたみ可能なアコーディオン形式
- **アセスメントサマリ**: 各モデルの評価要約（200-300文字）
- **フィルタリング機能**: モデル、カテゴリ、判定、リスクレベルで絞り込み
- **詳細表示**: スライドオーバーでエビデンス情報を確認
- **クリック可能なURL**: 証跡・根拠のURLが自動でリンク化
- **重複排除**: 最新のアセスメント結果のみを表示

### 生成AIモデルアセスメント画面 (`/admin`)
1. `/login` で管理者ログイン（デフォルト: admin/0000）
2. 生成AIモデル名とベンダーを入力
3. 「アセスメント実行」ボタンをクリック
4. **リアルタイム進捗表示**:
   - プログレスバー（0-100%）
   - ステップ別詳細進捗（初期化→情報収集→モデル作成→アセスメント実行→完了）
   - 各ステップの状態表示（実行中・完了・エラー）
5. 自動アセスメント結果のプレビュー
6. 必要に応じて修正して「評価を登録」
7. **古いアセスメント削除**: 重複したアセスメント結果の一括削除機能

### 初回セットアップ

アプリケーション初回起動時に以下が自動実行されます：
- 管理者ユーザーの作成（存在しない場合）
- 40件のセキュリティ評価項目のRedisへの投入

## 評価カテゴリ

| カテゴリ | 項目数 | 説明 |
|---------|--------|------|
| 法規制・プライバシー | 5 | GDPR、CCPA、データローカライゼーション等 |
| セキュリティ | 5 | 暗号化、アクセス制御、脆弱性管理等 |
| AI倫理 | 5 | 公平性、説明可能性、有害コンテンツ防止等 |
| 技術的健全性 | 5 | 精度、堅牢性、スケーラビリティ等 |
| 透明性・説明責任 | 5 | 文書化、利用規約、第三者監査等 |
| 持続可能性 | 3 | 環境影響、リソース効率等 |
| データガバナンス | 4 | データ品質、ライフサイクル管理等 |
| 統合・相互運用性 | 3 | API標準、データフォーマット等 |
| コスト・ROI | 3 | 総所有コスト、使用量ベース課金等 |
| ベンダー管理 | 2 | 財務健全性、SLA等 |

## データモデル

### Redis JSONキー

- `security_item:{itemId}`: セキュリティ評価項目
- `model:{modelId}`: LLMモデル情報
- `assessment:{assessmentId}`: 評価
- `assessment_item:{assessmentItemId}`: 評価項目
- `admin_user:{username}`: 管理者ユーザー
- `audit:{ulid}`: 監査ログ

## APIエンドポイント

### 公開API
- `GET /api/assessments`: 評価一覧取得
- `GET /api/security-items`: セキュリティ項目一覧取得

### 認証API
- `POST /api/login`: ログイン
- `POST /api/logout`: ログアウト

### 管理者API（要認証）
- `POST /api/admin/investigate`: モデルアセスメント実行（Tavily + GPT-4）
- `POST /api/admin/assessments`: アセスメント作成・保存
- `DELETE /api/assessments/cleanup`: 古いアセスメント削除

## デプロイ

### Vercelへのデプロイ

1. GitHubリポジトリにプッシュ
2. Vercelでプロジェクトをインポート
3. 環境変数を設定
4. デプロイ実行

### 環境変数（本番環境）

本番環境では以下の点に注意：
- `JWT_SECRET`: 十分に複雑なランダム文字列
- `ADMIN_PASSWORD_HASH`: 強力なパスワードのbcryptハッシュ
- `NODE_ENV=production`

## セキュリティ

- パスワードはbcryptでハッシュ化
- JWTトークンはHTTP-onlyクッキーで管理
- CSRF対策
- 入力値検証（zod）
- Rate limiting対応

## 監査とコンプライアンス

- 全ての評価作成・更新を監査ログに記録
- ユーザー、アクション、変更内容を追跡
- ISO 27001、SOC 2等の基準に準拠した評価項目

## 最新の機能と改善点

### v1.2.0 - 2024年12月
- ✨ **リアルタイム進捗表示**: アセスメント実行中の詳細な進捗とプログレスバー
- 🔗 **クリック可能なURL**: 証跡・根拠のURLが自動でリンク化される機能
- 📊 **アセスメントサマリ**: 各モデルの評価結果を200-300文字で自動要約
- 🗑️ **重複排除機能**: 古いアセスメント結果の一括削除機能
- 📈 **評価モデル数統計**: ダッシュボードに評価済みモデル数を表示
- 🎨 **UI統一**: 全ページでライトテーマに統一、視認性を向上
- 🔧 **Webpack対応**: TurbopackとWebpackの両方に対応、安定性を向上

### 技術的改善
- **用語統一**: 「評価」→「アセスメント」、「LLMモデル調査」→「生成AIモデルアセスメント」
- **データ重複排除**: フロントエンド・API・物理削除の3レベルで重複データを管理
- **エラーハンドリング**: Turbopack関連のエラーに対する代替手段を提供
- **レスポンシブデザイン**: テーブル列幅の最適化とモバイル対応の強化

## ライセンス

MIT License

## サポート

問題や質問がある場合は、GitHubのIssuesをご利用ください。
